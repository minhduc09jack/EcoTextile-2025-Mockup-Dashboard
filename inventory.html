<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quản lý Kho - EcoTextile</title>
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="style.css">

    <style>
        /* ===== Imported Main Theme CSS (short core extract) ===== */
        :root {
  --darkest: #1A2A3A;      /* primary dark */
  --dark-gray: #243B53;    /* deep navy */
  --taupe: #3E5C76;        /* muted blue */
  --light-beige: #9DB4C0;  /* soft pastel blue */
  --white: #FFFFFF;        /* giữ nguyên */
  --cream-bg: #E5E9F0;     /* cool light grey */
  --yellow-accent: #00D1D1;/* teal accent */
}


        body {
            background: var(--cream-bg);
            font-family: "Inter", system-ui, sans-serif;
            display: flex;
        }

        /* .sidebar {
            width: 260px;
            background: #2C2F36;
            color: #EEE9DA;
            padding: 24px 0;
            flex-shrink: 0;
        } */

        .nav {
            margin-top: 32px;
            display: flex;
            flex-direction: column;
        }

        .nav a {
            padding: 14px 28px;
            text-decoration: none;
            color: #EEE9DA;
            display: flex;
            gap: 12px;
            /* border-radius: 10px; */
        }

        .nav a.active,
        .nav a:hover {
            background: var(--yellow-accent);
            color: var(--darkest);
        }

        .main {
            flex: 1;
            padding: 40px;
        }

        .panel {
            background: var(--white);
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
        }

        .panel h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            border-bottom: 2px solid var(--taupe);
            padding-bottom: 10px;
            display: flex;
            gap: 10px;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
        }

        .toolbar input {
            padding: 10px;
            width: 240px;
            border-radius: 8px;
            border: 1px solid #bbb;
        }

        .toolbar button {
            background: var(--taupe);
            color: var(--white);
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            border-radius: 12px;
            overflow: hidden;
        }

        th,
        td {
            padding: 12px;
            border: 1px solid #ddd;
            font-size: 14px;
        }

        th {
            background: #f3f3f3;
        }

        .status-low {
            color: #D9534F;
            font-weight: 600;
        }

        .status-ok {
            color: #5CB85C;
            font-weight: 600;
        }

        #formModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, .4);
            justify-content: center;
            align-items: center;
        }

        .modal-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            width: 320px;
        }

        .modal-box input {
            padding: 8px;
            width: 100%;
            margin-bottom: 6px;
            border-radius: 8px;
            border: 1px solid #ccc;
        }

        .modal-box button {
            background: black;
            color: var(--darkest);
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <button class="hamburger" onclick="toggleSidebar()">
        ☰
    </button>
    <nav class="sidebar">
        <h1>EcoTextile</h1>
        <span>Nền tảng Công nghệ Bền vững</span>
        <div class="nav">
            <a href="index.html"><i data-feather="bar-chart-2"></i>Bảng điều khiển</a>
            <a href="inventory.html" class="active"><i data-feather="archive"></i>Kho</a>
            <a href="suppliers.html"><i data-feather="truck"></i>Nhà cung cấp</a>
            <a href="mockup-design-assistant.html"><i data-feather="cpu"></i>Trợ lý thiết kế</a>
            <a href="mockup-fabric-analysis.html"><i data-feather="layers"></i>Tối ưu vải</a>
            <a href="mockup-trend-analyzer.html"><i data-feather="trending-up"></i>Phân tích xu hướng</a>
            <a href="setting.html"><i data-feather="settings"></i>Cài đặt</a>
        </div>
    </nav>

    <main class="main">
        <div class="panel">
            <h2><i data-feather="archive"></i> Quản lý Kho</h2>
            <p>Theo dõi nguyên liệu thô & thành phẩm.</p>

            <div class="toolbar">
                <input type="text" id="searchInput" placeholder="Tìm kiếm kho...">
                <button onclick="openForm()"><i data-feather="plus"></i> Thêm mục</button>
            </div>

            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th onclick="sortTable(0)">Tên sản phẩm</th>
                        <th onclick="sortTable(1)">Mã SKU</th>
                        <th onclick="sortTable(2)">Chất liệu</th>
                        <th onclick="sortTable(3)">Tồn kho</th>
                        <th>Trạng thái</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Áo thun cotton nam</td>
                        <td>CM-TEE-001</td>
                        <td>Recycled Cotton</td>
                        <td>1200</td>
                        <td class="status-ok">Còn hàng</td>
                    </tr>
                    <tr>
                        <td>Quần short thể thao</td>
                        <td>CM-SRT-004</td>
                        <td>Recycled Polyester</td>
                        <td>850</td>
                        <td class="status-ok">Còn hàng</td>
                    </tr>
                    <tr>
                        <td>Khối bông hữu cơ</td>
                        <td>MAT-COT-002</td>
                        <td>Nguyên liệu thô</td>
                        <td>45</td>
                        <td class="status-low">Tồn kho thấp</td>
                    </tr>
                    <tr>
                        <td>Thuốc nhuộm chàm tự nhiên</td>
                        <td>MAT-DYE-007</td>
                        <td>Thuốc nhuộm tự nhiên</td>
                        <td>300</td>
                        <td class="status-ok">Còn hàng</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <!-- Modal Add Form -->
    <div id="formModal"
        style="display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.4); justify-content:center; align-items:center;">
        <div style="background:white; padding:20px; border-radius:10px; width:320px;">
            <h3>Thêm sản phẩm mới</h3><br>
            <input id="name" placeholder="Tên sản phẩm" style="width:100%; padding:8px; margin-bottom:6px;">
            <input id="sku" placeholder="Mã SKU" style="width:100%; padding:8px; margin-bottom:6px;">
            <input id="mat" placeholder="Chất liệu" style="width:100%; padding:8px; margin-bottom:6px;">
            <input id="stock" type="number" placeholder="Số lượng" style="width:100%; padding:8px; margin-bottom:6px;">
            <button onclick="addItem()"
                style="background:var(--yellow-accent); color:rgb(255, 255, 255); padding:8px; width:100%; border:none; border-radius:6px; margin-top:4px;">Lưu</button>
        </div>
    </div>

    <script>
        feather.replace();

        // === LOAD DATA FROM LOCAL STORAGE ===
        window.addEventListener("DOMContentLoaded", () => {
            const savedItems = JSON.parse(localStorage.getItem("inventory")) || [];
            const t = document.querySelector("#inventoryTable tbody");

            savedItems.forEach(item => {
                const row = document.createElement("tr");
                const statusClass = item.stock < 100 ? "status-low" : "status-ok";
                const statusText = item.stock < 100 ? "Tồn kho thấp" : "Còn hàng";
                row.innerHTML = `
      <td>${item.name}</td>
      <td>${item.sku}</td>
      <td>${item.mat}</td>
      <td>${item.stock}</td>
      <td class='${statusClass}'>${statusText}</td>
    `;
                t.appendChild(row);
            });
        });

        // === SORT TABLE ===
        function sortTable(col) {
            const table = document.getElementById("inventoryTable");
            const rows = Array.from(table.querySelectorAll("tbody tr"));
            const isNumeric = !isNaN(rows[0].cells[col].innerText.trim());

            rows.sort((a, b) => {
                let A = a.cells[col].innerText.trim();
                let B = b.cells[col].innerText.trim();
                if (isNumeric) return Number(A) - Number(B);
                return A.localeCompare(B);
            });

            rows.forEach(r => table.querySelector("tbody").appendChild(r));
        }

        // === SEARCH FILTER ===
        document.getElementById("searchInput").addEventListener("input", function () {
            let filter = this.value.toLowerCase();
            document.querySelectorAll("#inventoryTable tbody tr").forEach(row => {
                row.style.display = row.innerText.toLowerCase().includes(filter) ? "" : "none";
            });
        });

        // === OPEN & CLOSE FORM ===
        function openForm() { document.getElementById("formModal").style.display = "flex"; }
        function closeForm() { document.getElementById("formModal").style.display = "none"; }

        // Close modal when clicking outside form
        window.addEventListener("click", e => {
            if (e.target.id === "formModal") closeForm();
        });

        // === ADD ITEM TO TABLE + LOCAL STORAGE ===
        function addItem() {
            const nameVal = document.getElementById("name").value.trim();
            const skuVal = document.getElementById("sku").value.trim();
            const matVal = document.getElementById("mat").value.trim();
            const stockVal = parseInt(document.getElementById("stock").value.trim(), 10);

            if (!nameVal || !skuVal || !matVal || isNaN(stockVal)) {
                alert("Vui lòng điền tất cả các trường đúng.");
                return;
            }

            // create row for table
            const t = document.querySelector("#inventoryTable tbody");
            const row = document.createElement("tr");
            const statusClass = stockVal < 100 ? "status-low" : "status-ok";
            const statusText = stockVal < 100 ? "Tồn kho thấp" : "Còn hàng";

            row.innerHTML = `
    <td>${nameVal}</td>
    <td>${skuVal}</td>
    <td>${matVal}</td>
    <td>${stockVal}</td>
    <td class='${statusClass}'>${statusText}</td>
  `;
            t.appendChild(row);

            // === SAVE TO LOCAL STORAGE ===
            const savedItems = JSON.parse(localStorage.getItem("inventory")) || [];
            savedItems.push({
                name: nameVal,
                sku: skuVal,
                mat: matVal,
                stock: stockVal
            });
            localStorage.setItem("inventory", JSON.stringify(savedItems));

            // reset form
            document.getElementById("name").value = "";
            document.getElementById("sku").value = "";
            document.getElementById("mat").value = "";
            document.getElementById("stock").value = "";
            closeForm();
        }
        function toggleSidebar() {
            const sidebar = document.querySelector(".sidebar");
            const overlay = document.querySelector(".overlay");
            const body = document.body;

            sidebar.classList.toggle("active");
            overlay.classList.toggle("show");
            body.classList.toggle("sidebar-open");
        }

        function closeSidebar() {
            document.querySelector(".sidebar").classList.remove("active");
            document.querySelector(".overlay").classList.remove("show");
            document.body.classList.remove("sidebar-open");
        }
    </script>


</body>

</html>