<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quản lý Kho - EcoTextile</title>
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="style.css">

    <style>
        /* ===== Imported Main Theme CSS (short core extract) ===== */
        :root {
            --darkest: #1A2A3A;
            /* primary dark */
            --dark-gray: #243B53;
            /* deep navy */
            --taupe: #3E5C76;
            /* muted blue */
            --light-beige: #9DB4C0;
            /* soft pastel blue */
            --white: #FFFFFF;
            /* giữ nguyên */
            --cream-bg: #E5E9F0;
            /* cool light grey */
            --yellow-accent: #00D1D1;
            /* teal accent */
        }


        body {
            background: var(--cream-bg);
            font-family: "Inter", system-ui, sans-serif;
            display: flex;
        }

        /* .sidebar {
            width: 260px;
            background: #2C2F36;
            color: #EEE9DA;
            padding: 24px 0;
            flex-shrink: 0;
        } */

        .nav {
            margin-top: 32px;
            display: flex;
            flex-direction: column;
        }

        .nav a {
            padding: 14px 28px;
            text-decoration: none;
            color: #EEE9DA;
            display: flex;
            gap: 12px;
            /* border-radius: 10px; */
        }

        .nav a.active,
        .nav a:hover {
            background: var(--yellow-accent);
            color: var(--darkest);
        }

        .main {
            flex: 1;
            padding: 40px;
        }

        .panel {
            background: var(--white);
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
        }

        .panel h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            border-bottom: 2px solid var(--taupe);
            padding-bottom: 10px;
            display: flex;
            gap: 10px;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
        }

        .toolbar input {
            padding: 10px;
            width: 240px;
            border-radius: 8px;
            border: 1px solid #bbb;
        }

        .toolbar button {
            background: var(--taupe);
            color: var(--white);
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            border-radius: 12px;
            overflow: hidden;
        }

        th,
        td {
            padding: 12px;
            border: 1px solid #ddd;
            font-size: 14px;
        }

        th {
            background: #f3f3f3;
        }

        .status-low {
            color: #D9534F;
            font-weight: 600;
        }

        .status-ok {
            color: #5CB85C;
            font-weight: 600;
        }

        #formModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, .4);
            justify-content: center;
            align-items: center;
        }

        .modal-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            width: 320px;
        }

        .modal-box input {
            padding: 8px;
            width: 100%;
            margin-bottom: 6px;
            border-radius: 8px;
            border: 1px solid #ccc;
        }

        .modal-box button {
            background: black;
            color: var(--darkest);
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <button class="hamburger" onclick="toggleSidebar()">
        ☰
    </button>
    <nav class="sidebar">
        <h1>EcoTextile</h1>
        <span>Nền tảng Công nghệ Bền vững</span>
        <div class="nav">
            <a href="index.html"><i data-feather="bar-chart-2"></i>Bảng điều khiển</a>
            <a href="inventory.html" class="active"><i data-feather="archive"></i>Kho</a>
            <a href="suppliers.html"><i data-feather="truck"></i>Nhà cung cấp</a>
            <a href="mockup-design-assistant.html"><i data-feather="cpu"></i>Trợ lý thiết kế</a>
            <a href="mockup-fabric-analysis.html"><i data-feather="layers"></i>Tối ưu vải</a>
            <a href="mockup-trend-analyzer.html"><i data-feather="trending-up"></i>Phân tích xu hướng</a>
            <a href="setting.html"><i data-feather="settings"></i>Cài đặt</a>
        </div>
    </nav>

    <main class="main">
        <div class="panel">
            <h2><i data-feather="archive"></i> Quản lý Kho</h2>
            <p>Theo dõi nguyên liệu thô & thành phẩm.</p>

            <div class="toolbar">
                <div style="display:flex; gap:10px;">
                    <input type="text" id="searchInput" placeholder="Tìm kiếm...">

                    <select id="categoryFilter" style="padding:10px; border-radius:8px; border:1px solid #bbb;">
                        <option value="">Tất cả danh mục</option>
                        <option value="Thành phẩm">Thành phẩm</option>
                        <option value="Nguyên liệu thô">Nguyên liệu thô</option>
                        <option value="Phụ liệu – Hoá chất">Phụ liệu – Hoá chất</option>
                    </select>
                </div>

                <button onclick="openForm()"><i data-feather="plus"></i> Thêm mục</button>
            </div>



            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th onclick="sortTable(0)">Tên sản phẩm</th>
                        <th onclick="sortTable(1)">Mã SKU</th>
                        <th onclick="sortTable(2)">Chất liệu</th>
                        <th onclick="sortTable(3)">Tồn kho</th>
                        <th onclick="sortTable(4)">Danh mục</th>
                        <th>Trạng thái</th>
                    </tr>
                </thead>

                <tbody>
                    <tr>
                        <td>Áo thun cotton nam</td>
                        <td>CM-TEE-001</td>
                        <td>Recycled Cotton</td>
                        <td>1200</td>
                        <td class="status-ok">Còn hàng</td>
                    </tr>
                    <tr>
                        <td>Quần short thể thao</td>
                        <td>CM-SRT-004</td>
                        <td>Recycled Polyester</td>
                        <td>850</td>
                        <td class="status-ok">Còn hàng</td>
                    </tr>
                    <tr>
                        <td>Khối bông hữu cơ</td>
                        <td>MAT-COT-002</td>
                        <td>Nguyên liệu thô</td>
                        <td>45</td>
                        <td class="status-low">Tồn kho thấp</td>
                    </tr>
                    <tr>
                        <td>Thuốc nhuộm chàm tự nhiên</td>
                        <td>MAT-DYE-007</td>
                        <td>Thuốc nhuộm tự nhiên</td>
                        <td>300</td>
                        <td class="status-ok">Còn hàng</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <!-- Modal Add Form -->

    <div id="formModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Thêm sản phẩm mới</h3><br>

            <input id="name" placeholder="Tên sản phẩm">
            <input id="sku" placeholder="Mã SKU">
            <input id="mat" placeholder="Chất liệu">
            <input id="stock" type="number" placeholder="Số lượng">

            <select id="catInput">
                <option value="">Chọn danh mục</option>
                <option value="Thành phẩm">Thành phẩm</option>
                <option value="Nguyên liệu thô">Nguyên liệu thô</option>
                <option value="Phụ liệu – Hoá chất">Phụ liệu – Hoá chất</option>
            </select>

            <button onclick="addItem()" style="color: #E5E9F0;">Lưu</button>
        </div>
    </div>

    <script>
        // === SIDEBAR TOGGLE ===
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('active');
        }
        feather.replace();

        // === DEFAULT PRODUCTS ===
        const defaultProducts = [
            { name: "Áo hoodie unisex", sku: "FD-HDD-010", mat: "Organic Cotton", stock: 540, category: "Thành phẩm" },
            { name: "Váy midi dáng A", sku: "FD-SKT-014", mat: "Recycled Polyester", stock: 320, category: "Thành phẩm" },
            { name: "Áo polo thể thao", sku: "FD-POL-008", mat: "Coolmax Recycled Fiber", stock: 780, category: "Thành phẩm" },
            { name: "Túi tote canvas", sku: "ACC-BAG-003", mat: "Recycled Canvas", stock: 430, category: "Thành phẩm" },
            { name: "Sợi polyester tái chế", sku: "RAW-FIB-006", mat: "Recycled Polyester Fiber", stock: 260, category: "Nguyên liệu thô" },
            { name: "Vải cotton hữu cơ 2 lớp", sku: "RAW-FAB-004", mat: "Organic Cotton", stock: 150, category: "Nguyên liệu thô" },
            { name: "Sợi tre tự nhiên", sku: "RAW-BMB-002", mat: "Natural Bamboo Fiber", stock: 95, category: "Nguyên liệu thô" },
            { name: "Thuốc nhuộm gốc thực vật màu đỏ", sku: "CHM-DYE-009", mat: "Natural Plant Dye", stock: 180, category: "Phụ liệu – Hoá chất" },
            { name: "Chỉ may tái chế 60/3", sku: "ACC-THR-011", mat: "Recycled Thread", stock: 540, category: "Phụ liệu – Hoá chất" },
            { name: "Dây kéo kim loại tái chế", sku: "ACC-ZIP-012", mat: "Recycled Metal", stock: 220, category: "Phụ liệu – Hoá chất" }
        ];

        // === INIT LOCAL STORAGE ===
        if (!localStorage.getItem("inventory")) {
            localStorage.setItem("inventory", JSON.stringify(defaultProducts));
        }

        // === LOAD TABLE ===
        function loadTable() {
            const savedItems = JSON.parse(localStorage.getItem("inventory")) || [];
            const tbody = document.querySelector("#inventoryTable tbody");

            tbody.innerHTML = "";

            savedItems.forEach(item => {
                const row = document.createElement("tr");

                const low = item.stock < 100;
                row.innerHTML = `
            <td>${item.name}</td>
            <td>${item.sku}</td>
            <td>${item.mat}</td>
            <td>${item.stock}</td>
            <td>${item.category}</td>
            <td class="${low ? 'status-low' : 'status-ok'}">
                ${low ? 'Tồn kho thấp' : 'Còn hàng'}
            </td>
        `;

                tbody.appendChild(row);
            });
        }

        loadTable();

        // === SEARCH + FILTER ===
        document.getElementById("searchInput").addEventListener("input", filterTable);
        document.getElementById("categoryFilter").addEventListener("change", filterTable);

        function filterTable() {
            const keyword = document.getElementById("searchInput").value.toLowerCase();
            const category = document.getElementById("categoryFilter").value;

            document.querySelectorAll("#inventoryTable tbody tr").forEach(row => {
                const matchText = row.innerText.toLowerCase().includes(keyword);
                const matchCat = category === "" || row.cells[4].innerText === category;

                row.style.display = matchText && matchCat ? "" : "none";
            });
        }

        // === ADD ITEM ===
        function addItem() {
            const nameVal = document.getElementById("name").value;
            const skuVal = document.getElementById("sku").value;
            const matVal = document.getElementById("mat").value;
            const stockVal = Number(document.getElementById("stock").value);
            const catVal = document.getElementById("catInput").value;

            if (!nameVal || !skuVal || !matVal || !stockVal || !catVal) {
                alert("Vui lòng điền đầy đủ thông tin!");
                return;
            }

            const savedItems = JSON.parse(localStorage.getItem("inventory")) || [];

            savedItems.push({
                name: nameVal,
                sku: skuVal,
                mat: matVal,
                stock: stockVal,
                category: catVal
            });

            localStorage.setItem("inventory", JSON.stringify(savedItems));

            loadTable();
            closeForm();
        }

        // === MODAL ===
        function openForm() {
            document.getElementById("formModal").style.display = "flex";
        }
        function closeForm() {
            document.getElementById("formModal").style.display = "none";
        }

    </script>
</body>

</html>